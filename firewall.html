<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>Linux - Firewall</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="article toc2 toc-left data-line-1">
<div id="header">
<h1>Linux - Firewall</h1>
<div id="toc" class="toc2">
<div id="toctitle">Índice de Contenido</div>
<ul class="sectlevel1">
<li><a href="#_autores">1. <span class="icon"><i class="fa fa-group"></i></span> Autores</a></li>
<li><a href="#_introducción">2. <span class="icon"><i class="fa fa-save"></i></span> Introducción</a></li>
<li><a href="#_objetivos">3. <span class="icon"><i class="fa fa-check"></i></span> Objetivos</a></li>
<li><a href="#_antecedentes">4. <span class="icon"><i class="fa fa-map"></i></span> Antecedentes</a></li>
<li><a href="#_evidencia">5. <span class="icon"><i class="fa fa-hourglass"></i></span> Evidencia</a></li>
<li><a href="#_firewall">6. <span class="icon"><i class="fa fa-wrench"></i></span> Firewall</a>
<ul class="sectlevel2">
<li><a href="#_iptables">6.1. <em>IPTables</em></a>
<ul class="sectlevel3">
<li><a href="#_acerca_de_iptables">6.1.1. Acerca de <em>IPTables</em></a></li>
<li><a href="#_instalación">6.1.2. Instalación</a></li>
<li><a href="#_configuración">6.1.3. Configuración</a></li>
<li><a href="#_operación">6.1.4. Operación</a></li>
<li><a href="#_validación">6.1.5. Validación</a></li>
</ul>
</li>
<li><a href="#_nftables_actualización">6.2. <em>NFTables</em> (Actualización)</a>
<ul class="sectlevel3">
<li><a href="#_por_qué_usar_nftables">6.2.1. ¿Por qué usar <em>NFTables</em>?</a></li>
<li><a href="#_trabajar_con_tablas">6.2.2. Trabajar con TABLAS</a></li>
<li><a href="#_manual_de_configuración">6.2.3. MANUAL DE CONFIGURACIÓN</a></li>
<li><a href="#_script">6.2.4. Script</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_conclusiones_y_recomendaciones">7. <span class="icon"><i class="fa fa-envelope"></i></span> Conclusiones y Recomendaciones</a></li>
<li><a href="#_bibliografía"><span class="icon"><i class="fa fa-book"></i></span> Bibliografía</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1 data-line-15">
<h2 id="_autores">1. <span class="icon"><i class="fa fa-group"></i></span> Autores</h2>
<div class="sectionbody">
<div class="ulist data-line-1">
<ul>
<li class="data-line-1">
<p><span class="icon"><i class="fa fa-female"></i></span> <strong>Crysthel Aparicio Bonilla</strong></p>
</li>
<li class="data-line-2">
<p><span class="icon"><i class="fa fa-inbox"></i></span> <a href="mailto:crysthel.aparicio@unitec.edu">crysthel.aparicio@unitec.edu</a></p>
</li>
<li class="data-line-3">
<p><span class="icon"><i class="fa fa-calendar"></i></span> 2020-09-20 20:00 CST</p>
</li>
</ul>
</div>
<hr>
<div class="ulist data-line-7">
<ul>
<li class="data-line-7">
<p><span class="icon"><i class="fa fa-male"></i></span> <strong>Cristhian J. Alvarez</strong></p>
</li>
<li class="data-line-8">
<p><span class="icon"><i class="fa fa-inbox"></i></span> <a href="mailto:cristhianalvarez96@gmail.com">cristhianalvarez96@gmail.com</a></p>
</li>
<li class="data-line-9">
<p><span class="icon"><i class="fa fa-calendar"></i></span> 2020-09-20 20:00 CST</p>
</li>
</ul>
</div>
<hr>
<div class="ulist data-line-13">
<ul>
<li class="data-line-13">
<p><span class="icon"><i class="fa fa-male"></i></span> <strong>Ilich Andrés García</strong></p>
</li>
<li class="data-line-14">
<p><span class="icon"><i class="fa fa-inbox"></i></span> <a href="mailto:ilich-garcia@hotmail.com">ilich-garcia@hotmail.com</a></p>
</li>
<li class="data-line-15">
<p><span class="icon"><i class="fa fa-calendar"></i></span> 2020-09-20 20:00 CST</p>
</li>
</ul>
</div>
<hr>
<div class="ulist data-line-19">
<ul>
<li class="data-line-19">
<p><span class="icon"><i class="fa fa-female"></i></span> <strong>Suyapa Abigail Alvarado</strong></p>
</li>
<li class="data-line-20">
<p><span class="icon"><i class="fa fa-inbox"></i></span> <a href="mailto:abialvarado14@unitec.edu">abialvarado14@unitec.edu</a></p>
</li>
<li class="data-line-21">
<p><span class="icon"><i class="fa fa-calendar"></i></span> 2020-09-20 20:00 CST</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1 data-line-19">
<h2 id="_introducción">2. <span class="icon"><i class="fa fa-save"></i></span> Introducción</h2>
<div class="sectionbody">
<div class="paragraph data-line-1">
<p>Tenemos claro que los virus no son la única amenaza que existe en el mundo informático, pero sí conocemos de la importancia de mantener la seguridad en nuestras máquinas. El cortafuego es una de estas herramientas de seguridad, y una de las más útiles, pues su propósito es limitar qué entra y qué sale en nuestra red local a través de internet.</p>
</div>
<div class="paragraph data-line-3">
<p>Es posible encontrar cortafuegos para cualquier dispositivo. Incluso, el <em>router</em> que nos proporciona el acceso a internet funge como un cortafuego principal, pues a través de él se administra toda la información que recibimos o compartimos por la red. Para esto, existen distribuciones cuya única tarea es funcionar como <em>firewall</em> o <em>router</em>, así como otras características de seguridad. De esta forma, no sólo podremos utilizar el <em>router</em> para acceder a la red, sino que podremos configurarlo como una segunda barrera personalizada, y así lograr que nuestra red sea segura.</p>
</div>
<div class="paragraph data-line-5">
<p>Un cortafuegos o <em>firewall</em> es un dispositivo, ya sea de <em>hardware</em> o de <em>software</em>, que filtra todo el tráfico de red con el objetivo de brindar mayor seguridad al sistema. Un <em>firewall</em> es como un personal de seguridad, como una persona que solamente deja entrar el tráfico deseado y que bloquea el tráfico que no le interesa.</p>
</div>
<div class="paragraph data-line-7">
<p>A pesar de que en <em>Linux</em> posee muchas opciones para mantener el sistema protegido utilizando un cortafuego, en ocasiones hacer uso de algunas herramientas puede ser un tanto complicado para personas que no tienen conocimientos elevados.</p>
</div>
<div class="paragraph data-line-9">
<p>En esta ocasión, haremos una implementación de <em>IPTables</em> y de <em>NFTables</em> (una evolución de <em>IPTables</em>). <strong><em>IPTables</em></strong> es un <em>firewall</em> incluido en el kernel de <em>Linux</em> desde la versión 2.4. Es un <em>firewall</em> con un nivel alto en complejidad que está basado en reglas, y su funcionamiento se fundamenta en aplicar reglas que el mismo <em>firewall</em> ejecute, señalando que estas <em>IPTables</em> se encuentran en dispositivos <em>Android</em>, así como en firmwares basados en <em>Linux</em>.</p>
</div>
<div class="paragraph data-line-21">
<p>Por el otro lado, <strong><em>NFTables</em></strong> es la evolución hacia el filtrado de paquetes que hasta ahora representaba <em>IPTables</em>, se encuentra disponible desde kernels de <em>Linux</em> con versión 3.13. Posee una interfaz de comando diferente a <em>IPTables</em> y proporciona una nueva infraestructura con la que podremos construir concatenaciones y mapas. Esto nos permite organizar un conjunto de reglas en un árbol multidimensional, reduciendo de forma drástica la cantidad de reglas que se tienen que consultar hasta encontrar la acción que se aplica en el paquete.</p>
</div>
</div>
</div>
<div class="sect1 data-line-23">
<h2 id="_objetivos">3. <span class="icon"><i class="fa fa-check"></i></span> Objetivos</h2>
<div class="sectionbody">
<div class="ulist data-line-1">
<ul>
<li class="data-line-1">
<p>Conocer la importancia del uso de las distintas formas de proteger a nuestros dispositivos contra los ataques a los que los sistemas informáticos están expuestos.</p>
</li>
<li class="data-line-2">
<p>Comprender la utilidad de <em>IPTables</em> en un entorno <em>Linux</em> para ámbito personal, educativo, e incluso profesional.</p>
</li>
<li class="data-line-3">
<p>Desarrollar una implementación del uso del <em>firewall</em> <em>IPTables</em> que ejemplifique el funcionamiento de esta herramienta.</p>
</li>
<li class="data-line-4">
<p>Realizar una utilización de buenas prácticas en cuanto a la reducción de código e inconsistencias que serán mejor representadas mediante otra implementación correspondiente a <em>NFTables</em>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1 data-line-27">
<h2 id="_antecedentes">4. <span class="icon"><i class="fa fa-map"></i></span> Antecedentes</h2>
<div class="sectionbody">
<div class="paragraph data-line-1">
<p>El proyecto <em>Netfilter/IPTables</em> comenzó en 1998 por Rusty Russell, quien también fue autor del proyecto que lo precedió: <strong><em>IPChains</em></strong>. Según el proyecto iba creciendo, se fundó el <strong><em>Netfilter Core Team</em></strong> (o simplemente el <em>coreteam</em>) en 1999.</p>
</div>
<div class="paragraph data-line-3">
<p>Antes de <em>IPTables</em>, los programas más utilizados para crear cortafuegos en <em>Linux</em> eran <em>IPChains</em> en el núcleo <em>Linux</em> 2.2, e <em>IPfwadm</em> en el núcleo <em>Linux</em> 2.0. Tanto <em>IPChains</em> como <em>IPfwadm</em> alteran el código de red para manipular los paquetes, pues no existía un <em>framework</em> general para administrar paquetes hasta la aparición de <em>Netfilter</em>.</p>
</div>
<div class="paragraph data-line-5">
<p><em>IPTables</em> mantiene la idea básica introducida en <em>Linux</em> con <em>IPfwadm</em>: Listas de reglas donde se especifica qué matchear dentro de un paquete y qué hacer con ese paquete. <em>IPChains</em> agrega el concepto de cadenas de reglas (<em>chains</em>) e <em>IPTables</em> extendió esto a la idea de tablas: Se consultaba una tabla para decidir si había que <em>NATear</em> un paquete, y se consultaba otra para decidir cómo se filtraría un paquete. Además de esto, fueron modificados los 3 puntos en los que se realiza el filtrado en el viaje de un paquete, de modo que un paquete pase sólo por un punto de filtrado.</p>
</div>
<div class="paragraph data-line-29">
<p>Mientras que <em>IPChains</em> e <em>IPfwadm</em> combinan filtrado de paquetes y NAT (específicamente tres tipos de NAT, llamados <em>masquerading</em> o enmascaramiento de IP, <em>port forwarding</em> o redireccionamiento de puertos, y <em>redirection</em> o redirección), <em>NETFilter</em> hace posible por su parte separar las operaciones sobre los paquetes en tres partes: <em>Packet filtering</em> (filtrado de paquetes), <em>connection tracking</em> (seguimiento de conexiones) y <em>Network Address Translation</em> (NAT o traducción de direcciones de red).</p>
</div>
</div>
</div>
<div class="sect1 data-line-31">
<h2 id="_evidencia">5. <span class="icon"><i class="fa fa-hourglass"></i></span> Evidencia</h2>
<div class="sectionbody">
<div class="paragraph data-line-1">
<p>Esta división permite a <em>IPTables</em> usar la información que la capa de seguimiento de conexiones ha determinado acerca del paquete: esta información estaba antes asociada a NAT. Esto hace a <em>IPTables</em> superior a <em>IPChains</em>, ya que tiene la habilidad de monitorear el estado de una conexión y redirigir, modificar o detener los paquetes de datos basados en el estado de la conexión y no solamente por el origen, destino o contenido del paquete.</p>
</div>
<div class="paragraph data-line-3">
<p>Un cortafuego que utilice <em>IPTables</em> de este modo se llama cortafuegos <em>stateful</em>, contrario a <em>IPChains</em> que sólo permite crear un cortafuego <em>stateless</em> (excepto en casos muy limitados). Podemos decir entonces que <em>IPChains</em> no está al tanto del contexto completo en el cual un paquete surge, mientras que <em>IPTables</em> sí, y por lo tanto <em>IPTables</em> puede hacer mejores decisiones sobre el futuro de los paquetes y las conexiones.</p>
</div>
<div class="paragraph data-line-5">
<p><em>IPTables</em>, el subsistema NAT y el subsistema de seguimiento de conexiones son también extensibles, y muchas extensiones ya están incluidas en el paquete básico de <em>IPTables</em>, tal como la extensión ya mencionada que permite la consulta del estado de la conexión. Extensiones adicionales se distribuyen junto a la utilidad <em>IPTables</em>, como parches al código fuente del núcleo junto con una herramienta llamada <strong><em>patch-o-matic</em></strong>, que permite aplicar los parches.</p>
</div>
<div class="paragraph data-line-33">
<p>Una versión de <em>IPTables</em> para IPv6 ya fue escrita, llamada <strong><em>IP6Tables</em></strong>, al igual que la herramienta de administración.</p>
</div>
</div>
</div>
<div class="sect1 data-line-35">
<h2 id="_firewall">6. <span class="icon"><i class="fa fa-wrench"></i></span> Firewall</h2>
<div class="sectionbody">
<div class="sect2 data-line-1">
<h3 id="_iptables">6.1. <em>IPTables</em></h3>
<div class="sect3 data-line-3">
<h4 id="_acerca_de_iptables">6.1.1. Acerca de <em>IPTables</em></h4>
<hr>
<div class="paragraph data-line-7">
<p>Desde la versión 2.4 del Kernel de <em>Linux</em>, se imnplementó <em>IPTables</em> como <em>firewall</em> principal del sistema operativo.</p>
</div>
<div class="paragraph data-line-9">
<p>Éste se basa en la declaración de reglas y políticas.
El objetivo de estas declaraciones, es que el <em>firewall</em> pueda leerlas y ejecutar operaciones que mantengan la integridad de la red con respecto a éstas.</p>
</div>
<div class="paragraph data-line-12">
<p>Generalmente, podemos encontrar instalado este paquete en nuestros <em>firmwares</em> basados en <em>Linux</em>, incluyendo <em>Android</em>.
Sin embargo, solo soporta IPv4, para IPv6 se necesita utilizar en su lugar <em>IP6tTbles</em>.</p>
</div>
</div>
<div class="sect3 data-line-15">
<h4 id="_instalación">6.1.2. Instalación</h4>
<hr>
<div class="paragraph data-line-19">
<p>Si bien es cierto que <em>IPTables</em> se considera un paquete esencial en las distribuciones <em>Linux</em>, a continuación mostramos su instalación manual, sólo se requiere iniciar la consola en modo super-usuario o agregar el comando <em>sudo</em> al inicio de cada línea.</p>
</div>
<div class="sect4 data-line-21">
<h5 id="_verificación_inicial">6.1.2.1. Verificación Inicial</h5>
<div class="olist arabic data-line-23">
<ol class="arabic">
<li class="data-line-23">
<p>Ejecutar <strong><em>iptables -L</em></strong></p>
<div class="imageblock text-center data-line-25">
<div class="content">
<img src="images/iptables1-1.png" alt="iptables1 1">
</div>
</div>
<div class="paragraph data-line-27">
<p>Comprobamos que <em>IPTables</em> no está instalado en la máquina.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4 data-line-29">
<h5 id="_instalación_2">6.1.2.2. Instalación</h5>
<div class="olist arabic data-line-31">
<ol class="arabic">
<li class="data-line-31">
<p>Ejecutar <strong><em>apt-get update</em></strong></p>
<div class="imageblock text-center data-line-33">
<div class="content">
<img src="images/iptables2-1.png" alt="iptables2 1">
</div>
</div>
</li>
<li class="data-line-35">
<p>Ejecutar <strong><em>apt-get install iptables</em></strong></p>
<div class="imageblock text-center data-line-37">
<div class="content">
<img src="images/iptables2-2.png" alt="iptables2 2">
</div>
</div>
<div class="imageblock text-center data-line-39">
<div class="content">
<img src="images/iptables2-3.png" alt="iptables2 3">
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4 data-line-41">
<h5 id="_verificación_de_instalación">6.1.2.3. Verificación de Instalación</h5>
<div class="olist arabic data-line-43">
<ol class="arabic">
<li class="data-line-43">
<p>Ejecutar <strong><em>iptables -L</em></strong></p>
<div class="imageblock text-center data-line-45">
<div class="content">
<img src="images/iptables3-1.png" alt="iptables3 1">
</div>
</div>
<div class="paragraph data-line-47">
<p>Comprobamos que <em>IPTables</em> está instalado en la máquina.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3 data-line-49">
<h4 id="_configuración">6.1.3. Configuración</h4>
<hr>
<div class="sect4 data-line-52">
<h5 id="_creación_de_archivo_de_configuración_iptables_config_bash">6.1.3.1. Creación de Archivo de configuración - <em>iptables.config.bash</em></h5>
<div class="paragraph data-line-54">
<p>A pesar de existen comandos que directamente configuran las reglas y políticas, optamos por definir éstas en un sólo archivo para poder dar un seguimiento, mantenimiento y administración del <em>firewall</em> de una manera más amigable y clara.</p>
</div>
<div class="olist arabic data-line-56">
<ol class="arabic">
<li class="data-line-56">
<p>Ejecutar <strong><em>vi iptables.config.bash</em></strong></p>
<div class="imageblock text-center data-line-58">
<div class="content">
<img src="images/iptables4-1.png" alt="iptables4 1">
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4 data-line-60">
<h5 id="_eliminación_de_reglas_existentes">6.1.3.2. Eliminación de Reglas Existentes</h5>
<div class="paragraph data-line-62">
<p>En caso de querer configurar el <em>firewall</em> desde cero, omitiendo las reglas presetablecidas por el sistema o por un usuario previo, eliminamos las reglas activas existentes.</p>
</div>
<div class="olist arabic data-line-64">
<ol class="arabic">
<li class="data-line-64">
<p>Añadir <strong><em>iptables -F</em></strong> (borra las reglas de una cadena).</p>
</li>
<li class="data-line-66">
<p>Añadir <strong><em>iptables -X</em></strong> (borra una cadena).</p>
</li>
<li class="data-line-68">
<p>Añadir <strong><em>iptables -Z</em></strong> (reinicia a 0 los contadores de una cadena).</p>
</li>
<li class="data-line-70">
<p>Añadir <strong><em>iptables -t nat -F</em></strong> (borra las reglas de la tabla de enrutamiento <em>nat</em>).</p>
<div class="imageblock text-center data-line-72">
<div class="content">
<img src="images/iptables4-2.png" alt="iptables4 2">
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4 data-line-74">
<h5 id="_políticas_por_defecto">6.1.3.3. Políticas por defecto</h5>
<div class="paragraph data-line-76">
<p>Por defecto se debe configurar el <em>firewall</em> de manera que acepte todas las conexiones.</p>
</div>
<div class="olist arabic data-line-78">
<ol class="arabic">
<li class="data-line-78">
<p>Añadir <strong><em>iptables -P INPUT ACCEPT</em></strong> (aceptar conexiones entrantes).</p>
</li>
<li class="data-line-80">
<p>Añadir <strong><em>iptables -P FORWARD ACCEPT</em></strong> (aceptar conexiones internas).</p>
</li>
<li class="data-line-82">
<p>Añadir <strong><em>iptables -P OUTPUT ACCEPT</em></strong> (aceptar conexiones salientes).</p>
</li>
<li class="data-line-84">
<p>Añadir <strong><em>iptables -t nat -P PREROUTING ACCEPT</em></strong> (aceptar conexiones destino de la tabla <em>nat</em>).</p>
</li>
<li class="data-line-86">
<p>Añadir <strong><em>iptables -t nat -P POSTROUTING ACCEPT</em></strong> (aceptar conexiones origen de la tabla <em>nat</em>).</p>
<div class="imageblock text-center data-line-88">
<div class="content">
<img src="images/iptables4-3.png" alt="iptables4 3">
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4 data-line-90">
<h5 id="_comunicaciones_localhost">6.1.3.4. Comunicaciones <em>localhost</em></h5>
<div class="paragraph data-line-92">
<p>Para evitar errores en el sistema, aceptamos todas las comunicaciones del localhost.</p>
</div>
<div class="olist arabic data-line-94">
<ol class="arabic">
<li class="data-line-94">
<p>Añadir <strong><em>iptables -A INPUT -p tcp -s localhost -j ACCEPT</em></strong> (Aceptar conexiones entrantes)</p>
<div class="imageblock text-center data-line-96">
<div class="content">
<img src="images/iptables4-4.png" alt="iptables4 4">
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4 data-line-98">
<h5 id="_comunicaciones_personalizadas_denegación">6.1.3.5. Comunicaciones Personalizadas (Denegación)</h5>
<div class="paragraph data-line-100">
<p>Denegamos las comunicaciones que no nos interesan.</p>
</div>
<div class="olist arabic data-line-102">
<ol class="arabic">
<li class="data-line-102">
<p>Añadir <strong><em>iptables -A FORWARD -s 10.0.1.0/24 -j DROP</em></strong> (Ejemplo: Denegamos las comunicaciones en la red 10.0.1.0/24)</p>
<div class="imageblock text-center data-line-104">
<div class="content">
<img src="images/iptables4-5.png" alt="iptables4 5">
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4 data-line-106">
<h5 id="_comunicaciones_personalizadas_aceptación_de_puertos">6.1.3.6. Comunicaciones Personalizadas (Aceptación de Puertos)</h5>
<div class="paragraph data-line-108">
<p>Aceptamos las comunicaciones de los puertos que nos interesan.</p>
</div>
<div class="olist arabic data-line-110">
<ol class="arabic">
<li class="data-line-110">
<p>Añadir <strong><em>iptables -A FORWARD -s 10.0.0.0/8 -p tcp --dport 25 -j ACCEPT</em></strong> (ejemplo: Aceptamos las comunicaciones en el puerto <em>tcp</em> 25).</p>
</li>
<li class="data-line-112">
<p>Añadir <strong><em>iptables -A FORWARD -s 10.0.0.0/8 -p tcp --dport 110 -j ACCEPT</em></strong> (ejemplo: Aceptamos las comunicaciones en el puerto <em>tcp</em> 110).</p>
</li>
<li class="data-line-114">
<p>Añadir <strong><em>iptables -A FORWARD -s 10.0.0.0/8 -p tcp --dport 20 -j ACCEPT</em></strong> (ejemplo: Aceptamos las comunicaciones en el puerto <em>tcp</em> 20).</p>
</li>
<li class="data-line-116">
<p>Añadir <strong><em>iptables -A FORWARD -s 10.0.0.0/8 -p tcp --dport 21 -j ACCEPT</em></strong> (ejemplo: Aceptamos las comunicaciones en el puerto <em>tcp</em> 21).</p>
</li>
<li class="data-line-118">
<p>Añadir <strong><em>iptables -A FORWARD -s 10.0.0.0/8 -p tcp --dport 53 -j ACCEPT</em></strong> (ejemplo: Aceptamos las comunicaciones en el puerto <em>tcp</em> 53).</p>
</li>
<li class="data-line-120">
<p>Añadir <strong><em>iptables -A FORWARD -s 10.0.0.0/8 -p udp --dport 53 -j ACCEPT</em></strong> (ejemplo: Aceptamos las comunicaciones en el puerto <em>udp</em> 53).</p>
<div class="imageblock text-center data-line-122">
<div class="content">
<img src="images/iptables4-6.png" alt="iptables4 6">
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4 data-line-124">
<h5 id="_nat">6.1.3.7. NAT</h5>
<div class="paragraph data-line-126">
<p>Activamos el enmascaramiento en la tabla <em>nat</em>.</p>
</div>
<div class="olist arabic data-line-128">
<ol class="arabic">
<li class="data-line-128">
<p>Añadir <strong><em>iptables -t nat -A POSTROUTING -s 10.0.0.0/8 -o eth0 -j MASQUERADE</em></strong></p>
<div class="imageblock text-center data-line-130">
<div class="content">
<img src="images/iptables4-7.png" alt="iptables4 7">
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4 data-line-132">
<h5 id="_activación_de_configuraciones_de_enrutamiento">6.1.3.8. Activación de Configuraciones de Enrutamiento</h5>
<div class="paragraph data-line-134">
<p>Activamos las configuraciones del enrutamiento.</p>
</div>
<div class="olist arabic data-line-136">
<ol class="arabic">
<li class="data-line-136">
<p>Añadir <strong><em>echo 1 &gt; /proc/sys/net/ipv4/ip_forward</em></strong></p>
<div class="imageblock text-center data-line-138">
<div class="content">
<img src="images/iptables4-8.png" alt="iptables4 8">
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4 data-line-140">
<h5 id="_guardar_configuraciones">6.1.3.9. Guardar configuraciones</h5>

</div>
</div>
<div class="sect3 data-line-142">
<h4 id="_operación">6.1.4. Operación</h4>
<hr>
<div class="sect4 data-line-145">
<h5 id="_asignación_de_permisos_del_archivo_de_configuración_iptables_config_bash">6.1.4.1. Asignación de Permisos del Archivo de Configuración - <em>iptables.config.bash</em></h5>
<div class="paragraph data-line-147">
<p>Para poder ejecutar el archivo creado, necesitamos darle permisos de ejecución.</p>
</div>
<div class="olist arabic data-line-149">
<ol class="arabic">
<li class="data-line-149">
<p>Ejecutar <strong><em>chmod 4777 ./iptables.config.bash</em></strong></p>
<div class="imageblock text-center data-line-151">
<div class="content">
<img src="images/iptables5-1.png" alt="iptables5 1">
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4 data-line-153">
<h5 id="_ejecución_de_creación_de_archivo_de_configuración_iptables_config_bash">6.1.4.2. Ejecución de Creación de Archivo de Configuración - <em>iptables.config.bash</em></h5>
<div class="paragraph data-line-155">
<p>Para que las configuraciones que escribimos se apliquen, procedemos a ejecutar el archivo que creamos.</p>
</div>
<div class="olist arabic data-line-157">
<ol class="arabic">
<li class="data-line-157">
<p>Ejecutar <strong><em>bash ./iptables.config.bash</em></strong></p>
<div class="imageblock text-center data-line-159">
<div class="content">
<img src="images/iptables5-2.png" alt="iptables5 2">
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3 data-line-161">
<h4 id="_validación">6.1.5. Validación</h4>
<hr>
<div class="paragraph data-line-165">
<p>Para visualizar las reglas activas ejecutamos el comando <strong><em>iptables -L -v</em></strong></p>
</div>
<div class="imageblock text-center data-line-167">
<div class="content">
<img src="images/iptables6-1.png" alt="iptables6 1">
</div>
</div>
<div class="paragraph data-line-37">
<p>Podemos ver que las reglas que especificamos ya están activas, por lo tanto, el <em>firewall</em> está activo y configurado.</p>
</div>
</div>
</div>
<div class="sect2 data-line-1">
<h3 id="_nftables_actualización">6.2. <em>NFTables</em> (Actualización)</h3>
<div class="paragraph data-line-3">
<p><em>NFTables</em> es la evolución hacia el filtrado de paquetes que hasta ahora representaba <em>iptables</em>.</p>
</div>
<div class="ulist data-line-5">
<ul>
<li class="data-line-5">
<p>Está disponible desde <em>kernels</em> <em>Linux</em> 3.13.</p>
</li>
<li class="data-line-6">
<p>Tiene una nueva interfaz de comando cuya sintaxis es diferente de <em>IPTables</em>.</p>
</li>
<li class="data-line-7">
<p>Proporciona una nueva infraestructura que permite construir mapas y concatenaciones. Esta nueva característica le permite organizar un conjunto de reglas en un árbol multidimensional, lo que reduce la cantidad de reglas que deben consultarse drásticamente hasta encontrar la acción que se aplica en el paquete.</p>
</li>
</ul>
</div>
<div class="sect3 data-line-10">
<h4 id="_por_qué_usar_nftables">6.2.1. ¿Por qué usar <em>NFTables</em>?</h4>
<div class="ulist data-line-12">
<ul>
<li class="data-line-12">
<p>Evita la duplicación de código y las inconsistencias.</p>
</li>
<li class="data-line-13">
<p>Ordena los paquetes más rápido con un conjunto de mapeo de datos mejorado.</p>
</li>
<li class="data-line-14">
<p>Simplifica la administración de IPv4 e IPv6 con una nueva familia, <em>inet</em>, que le permite registrar cadenas que pueden ver el tráfico IPv4 e IPv6.</p>
</li>
<li class="data-line-15">
<p>Proporciona una API de <em>Netlink</em> para aplicaciones de terceros.</p>
</li>
<li class="data-line-16">
<p>Proporciona una sintaxis más amigable y compacta.</p>
</li>
</ul>
</div>
<div class="sect4 data-line-18">
<h5 id="_ganchos_netfilter_netfilter_hooks">6.2.1.1. <strong>Ganchos <em>Netfilter</em> (<em>Netfilter Hooks</em>)</strong></h5>
<div class="paragraph data-line-20">
<p><em>NFTables</em> reutiliza la infraestructura de enlace existente, el sistema de seguimiento de conexiones, el motor NAT, el registro de infraestructura, la gestión de colas, etc. Por lo tanto, sólo se ha reemplazado la infraestructura de clasificación de paquetes.</p>
</div>
<div class="paragraph data-line-22">
<p><em>Aquí hay una representación de estos ganchos (hooks):</em></p>
</div>
<div class="imageblock text-center data-line-24">
<div class="content">
<img src="images/nf25.PNG" alt="nf25">
</div>
</div>
<div class="paragraph data-line-26">
<p>Básicamente, el flujo de tráfico entrante a la máquina local verá el enlace entrante y el enrutamiento previo. Luego, <em>el tráfico generado por los procesos locales sigue la ruta de salida y el enrutamiento posterior</em>. Ruta superior en el gráfico anterior.
Y luego, los paquetes que no están destinados a nuestra máquina serán vistos por el gancho (<em>hook</em>) de entrada (previo a la decisión de enrutamiento). En resumen, los paquetes que no se dirigen a un proceso local (como un servidor Web) seguirán esta ruta: <mark>prerouting &#8594; decisión de enrutamiento &#8594; forward &#8594; postrouting. Ruta inferior en el gráfico anterior.</mark></p>
</div>
</div>
<div class="sect4 data-line-29">
<h5 id="_gancho_hook_de_entrada_ingress">6.2.1.2. <strong>GANCHO (<em>HOOK</em>) DE ENTRADA (<em>INGRESS</em>)</strong></h5>
<div class="paragraph data-line-31">
<p>Desde el <em>kernel</em> 4.2 de <em>Linux</em>, <em>Netfilter</em> también viene con un enlace de entrada que se puede usar desde <em>NFTables</em>. Entonces el proceso ahora será el siguiente:</p>
</div>
<div class="imageblock text-center data-line-33">
<div class="content">
<img src="images/nf26.PNG" alt="nf26">
</div>
</div>
</div>
</div>
<div class="sect3 data-line-36">
<h4 id="_trabajar_con_tablas">6.2.2. Trabajar con TABLAS</h4>
<div class="paragraph data-line-38">
<p><em>NFTables</em> se compone de tablas, y tablas de cadenas. Similar a <em>IPTables</em>.
Lo primero que tenemos que hacer para comenzar a trabajar con <em>NFTables</em> es agregar al menos una tabla. Luego, podemos agregar cadenas y agregaremos las reglas a esas cadenas.</p>
</div>
<div class="paragraph data-line-41">
<p><strong>Tenemos seis tipos diferentes de tablas según la familia a la que pertenecen:</strong></p>
</div>
<div class="ulist data-line-43">
<ul>
<li class="data-line-43">
<p>IP (IPv4).</p>
</li>
<li class="data-line-44">
<p><em>arp</em>.</p>
</li>
<li class="data-line-45">
<p><em>ip6</em>.</p>
</li>
<li class="data-line-46">
<p><em>Bridge</em>.</p>
</li>
<li class="data-line-47">
<p><em>inet</em>, que está disponible desde el <em>kernel</em> de <em>Linux</em> 3.14. Esta tabla es una tabla híbrida IPV4 + IPV6 que debería ayudar a simplificar la carga de la administración de <em>firewall</em> doble. Por lo tanto, las cadenas que registramos en esta tabla servirán para ver el tráfico IPv4 e IPv6.</p>
</li>
<li class="data-line-48">
<p><em>netdev</em>, disponible desde el <em>kernel</em> 4.2 de <em>Linux</em>. Esta familia viene con un enlace de entrada que se puede usar para registrar una cadena que filtra en una etapa muy temprana, es decir, antes del enrutamiento, como una alternativa a la infraestructura existente.</p>
</li>
</ul>
</div>
</div>
<div class="sect3 data-line-50">
<h4 id="_manual_de_configuración">6.2.3. MANUAL DE CONFIGURACIÓN</h4>
<div class="quoteblock data-line-52">
<blockquote>
<div class="paragraph data-line-1">
<p>Primero vamos a instalar <em>NFTables</em> con el siguiente comando:</p>
</div>
</blockquote>
</div>
<div class="listingblock data-line-55">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash"># apt install nftables</code></pre>
</div>
</div>
<div class="imageblock text-center data-line-58">
<div class="content">
<img src="images/nf1.PNG" alt="nf1">
</div>
</div>
<hr>
<div class="quoteblock data-line-61">
<blockquote>
<div class="paragraph data-line-1">
<p>Verificar de manera elegante que el paquete si este instalado con el comando:</p>
</div>
</blockquote>
</div>
<div class="listingblock data-line-64">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash"># apt-cache search nftables</code></pre>
</div>
</div>
<div class="imageblock text-center data-line-67">
<div class="content">
<img src="images/nf2.PNG" alt="nf2">
</div>
</div>
<hr>
<div class="quoteblock data-line-70">
<blockquote>
<div class="paragraph data-line-1">
<p>Verificar el estado de este servicio:</p>
</div>
</blockquote>
</div>
<div class="listingblock data-line-73">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash"># service nftables status</code></pre>
</div>
</div>
<div class="imageblock text-center data-line-76">
<div class="content">
<img src="images/nf3.PNG" alt="nf3">
</div>
</div>
<div class="paragraph data-line-78">
<p>Podemos verificar que esta activo. La orden <mark>systemctl enable nftables.service</mark> establece que el servicio nftables arranque con el sistema.
---</p>
</div>
<div class="quoteblock data-line-81">
<blockquote>
<div class="paragraph data-line-1">
<p>Si el sistema arranca el siguiente fichero también arranca:</p>
</div>
</blockquote>
</div>
<div class="listingblock data-line-84">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash"># cat /etc/nftables.conf</code></pre>
</div>
</div>
<div class="imageblock text-center data-line-87">
<div class="content">
<img src="images/nf4.PNG" alt="nf4">
</div>
</div>
<div class="paragraph data-line-89">
<p>Generalmente aparece de esta manera, cuando se es configurado por primera vez, este fichero no tiene nada prácticamente ya que borra cualquier tipo de regla y no establece reglas de cadenas.
<em>Configurando y aprendiendo un poco sobre este fichero ejecute algunos cambios como prueba del mismo:</em></p>
</div>
<div class="imageblock text-center data-line-92">
<div class="content">
<img src="images/nf5.PNG" alt="nf5">
</div>
</div>
<hr>
<div class="quoteblock data-line-95">
<blockquote>
<div class="paragraph data-line-1">
<p>Vamos a realizar un script, primero vamos a ver las reglas definidas:</p>
</div>
</blockquote>
</div>
<div class="listingblock data-line-98">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash"># nft list ruleset</code></pre>
</div>
</div>
<div class="imageblock text-center data-line-101">
<div class="content">
<img src="images/nf6.PNG" alt="nf6">
</div>
</div>
<hr>
<div class="quoteblock data-line-104">
<blockquote>
<div class="paragraph data-line-1">
<p>Necesitamos saber la ip de nuestra máquina para ello será lo siguiente:</p>
</div>
</blockquote>
</div>
<div class="listingblock data-line-107">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash"># ip a</code></pre>
</div>
</div>
<div class="imageblock text-center data-line-110">
<div class="content">
<img src="images/nf7.PNG" alt="nf7">
</div>
</div>
<hr>
<div class="quoteblock data-line-113">
<blockquote>
<div class="paragraph data-line-1">
<p>Se creo una carpeta para realizar el script</p>
</div>
</blockquote>
</div>
<div class="imageblock text-center data-line-115">
<div class="content">
<img src="images/nf8.PNG" alt="nf8">
</div>
</div>
<hr>
</div>
<div class="sect3 data-line-119">
<h4 id="_script">6.2.4. Script</h4>
<div class="paragraph data-line-121">
<p>Definamos las especificaciones del diseño
Vamos a configurar un <em>firewall</em> en un Servidor con una sola interface de red,  La IP de nuestra máquina es la <strong>10.0.2.0/24.</strong>
Los criterios son los siguientes:</p>
</div>
<div class="ulist data-line-125">
<ul>
<li class="data-line-125">
<p>Borrar las reglas iniciales que puedan existir.</p>
</li>
<li class="data-line-126">
<p>Solo nos preocuparemos de IPv4, dejando IPv6, nat, mangle, etc.. para ejemplos posteriores.</p>
</li>
<li class="data-line-127">
<p>Política por defecto DROP en nuestra máquina</p>
</li>
<li class="data-line-128">
<p>Permitir acceso ssh al servidor desde cualquier máquina de la red local</p>
</li>
<li class="data-line-129">
<p>Permitir tráfico de salida dns <strong>(udp/53)</strong></p>
</li>
<li class="data-line-130">
<p>Permitir tráfico de salida http, https, ssh <strong>(tcp/22,tcp/80,tcp/443)</strong></p>
</li>
<li class="data-line-131">
<p>Queremos llevar cuenta de los paquetes que cumplen cada regla para estudio y optimización posterior del <em>firewall</em>.</p>
</li>
</ul>
</div>
<div class="listingblock data-line-134">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash"># nano reglas.nft</code></pre>
</div>
</div>
<div class="imageblock text-center data-line-138">
<div class="content">
<img src="images/nf9.PNG" alt="nf9">
</div>
</div>
<div class="paragraph data-line-140">
<p><strong>Uso de Variable</strong></p>
</div>
<div class="imageblock text-center data-line-142">
<div class="content">
<img src="images/nf10.PNG" alt="nf10">
</div>
</div>
<div class="paragraph data-line-144">
<p><mark>22 es para ssh, 80 es http, y 443 es para https.</mark></p>
</div>
<hr>
<div class="imageblock text-center data-line-148">
<div class="content">
<img src="images/nf11.PNG" alt="nf11">
</div>
</div>
<div class="paragraph data-line-149">
<p>Nuestra tabla se llama filtrado, se puede usar ip, ip6, inet.</p>
</div>
<hr>
<div class="imageblock text-center data-line-153">
<div class="content">
<img src="images/nf12.PNG" alt="nf12">
</div>
</div>
<div class="paragraph data-line-154">
<p>INPUT, FORWARD, OUTPUT son las cadenas pueden tener cualquier nombre y lo que se debe respetar son los hooks.
*Input= Todas las reglas que me interesan que vayan en destino a mi maquina local.</p>
</div>
<div class="paragraph data-line-157">
<p>*Forward= bloque de reglas donde pasa el servidor.</p>
</div>
<div class="paragraph data-line-159">
<p>*Output= Pasaran todas las reglas que desde mi maquina salgan hacia externas.
Max prioridad es 0.</p>
</div>
<hr>
<div class="imageblock text-center data-line-163">
<div class="content">
<img src="images/nf13.PNG" alt="nf13">
</div>
</div>
<div class="paragraph data-line-164">
<p>Permitir el tráfico sobre loopback, donde se agrega la cadena de regla, esto es como tener en iptable: <mark>iptables -A INPUT -i o -h ACCEPT</mark></p>
</div>
<hr>
<div class="imageblock text-center data-line-168">
<div class="content">
<img src="images/nf14.PNG" alt="nf14">
</div>
</div>
<div class="paragraph data-line-169">
<p>Toma las redes locales y activar los contadores. Se permite el trafico de entrada y de salida</p>
</div>
<hr>
<div class="imageblock text-center data-line-173">
<div class="content">
<img src="images/nf15.PNG" alt="nf15">
</div>
</div>
<div class="paragraph data-line-174">
<p><mark>$udpSI</mark> toma las consulas DNS, luego la conexión entra por ssh. No hay bucle solo se repiten instrucciones de cada valor. nft se encarga de aplicar las reglas de OUTPUT e INPUT a todos los puertos definidos en las variables <strong>udpSI y tcpSI</strong>. NO es necesario un bucle como con iptables. Al menos pare esto.</p>
</div>
<div class="paragraph data-line-177">
<p>Para ejecutarlo bastará con llamar al script desde la línea de comandos</p>
</div>
<div class="imageblock text-center data-line-179">
<div class="content">
<img src="images/nf16.PNG" alt="nf16">
</div>
</div>
<hr>
<div class="paragraph data-line-183">
<p>En el siguiente paso vemos que no necesita permisos para ser ejecutado y vemos el ruleset, No es necesario que el Script <strong>/root/fw/reglas.nft</strong> tenga permiso de ejecución. Las reglas activas son las siguientes:</p>
</div>
<div class="imageblock text-center data-line-185">
<div class="content">
<img src="images/nf17.PNG" alt="nf17">
</div>
</div>
<hr>
<div class="paragraph data-line-189">
<p>Vamos a ejecutar un ping para ver el listado de las reglas ojo con 0 bytes y 0 accept en la imagen anterior, ahora veamos como estas cambian.</p>
</div>
<div class="imageblock text-center data-line-191">
<div class="content">
<img src="images/nf18.PNG" alt="nf18">
</div>
</div>
<hr>
<div class="paragraph data-line-195">
<p>Vamos a correr el servidor apache</p>
</div>
<div class="imageblock text-center data-line-197">
<div class="content">
<img src="images/nf19.PNG" alt="nf19">
</div>
</div>
<hr>
<div class="paragraph data-line-201">
<p>Pruebas con ping aquí vemos como mi política de drop y resolución ha funcionado</p>
</div>
<div class="imageblock text-center data-line-203">
<div class="content">
<img src="images/nf20.PNG" alt="nf20">
</div>
</div>
<div class="paragraph data-line-205">
<p><strong>nslookup funcionando correctamente</strong></p>
</div>
<div class="imageblock text-center data-line-207">
<div class="content">
<img src="images/nf21.PNG" alt="nf21">
</div>
</div>
<div class="paragraph data-line-209">
<p><strong>Podemos hacer update o upgrade con el script</strong></p>
</div>
<div class="imageblock text-center data-line-211">
<div class="content">
<img src="images/nf22.PNG" alt="nf22">
</div>
</div>
<div class="paragraph data-line-213">
<p><strong>Ahora si tenemos acceso.</strong></p>
</div>
<div class="imageblock text-center data-line-215">
<div class="content">
<img src="images/nf23.PNG" alt="nf23">
</div>
</div>
<hr>
</div>
</div>
</div>
</div>
<div class="sect1 data-line-41">
<h2 id="_conclusiones_y_recomendaciones">7. <span class="icon"><i class="fa fa-envelope"></i></span> Conclusiones y Recomendaciones</h2>
<div class="sectionbody">
<div class="ulist data-line-1">
<ul>
<li class="data-line-1">
<p>Se logró comprender la importancia del uso de las distintas formas de proteger a nuestros dispositivos contra los ataques a los que los sistemas informáticos están expuestos.</p>
</li>
<li class="data-line-2">
<p>Pudo entenderse la utilidad de <em>IPTables</em> en el entorno <em>Linux</em> para ámbito personal, educativo, y profesional.</p>
</li>
<li class="data-line-3">
<p>Fue desarrollada una implementación del uso del <em>firewall</em> <em>IPTables</em>, con el fin de ejemplificar el funcionamiento de esta herramienta.</p>
</li>
<li class="data-line-4">
<p>Se utilizaron buenas prácticas en cuanto a la reducción de código e inconsistencias, mejor representadas mediante implementación correspondiente a <em>NFTables</em>.</p>
</li>
</ul>
</div>
</div>
</div>
<h1 id="_bibliografía" class="sect0 data-line-45"><span class="icon"><i class="fa fa-book"></i></span> Bibliografía</h1>
<div class="ulist data-line-47">
<ul>
<li class="data-line-47">
<p><span class="icon"><i class="fa fa-book"></i></span> <a href="https://upcloud.com/community/tutorials/configure-iptables-debian/?utm_term=&amp;utm_campaign=DSA&amp;utm_source=adwords&amp;utm_medium=ppc&amp;hsa_acc=9391663435&amp;hsa_cam=7185608860&amp;hsa_grp=81739862313&amp;hsa_ad=391197952986&amp;hsa_src=g&amp;hsa_tgt=aud-877864361444:dsa-460992423274&amp;hsa_kw=&amp;hsa_mt=b&amp;hsa_net=adwords&amp;hsa_ver=3&amp;gclid=CjwKCAjw-5v7BRAmEiwAJ3DpuMRLUJcVWBRlpdr2MrETs8RfnV2IHKyoYVVJgnQgBIxIqFVsGu7gghoCVmcQAvD_BwE">Ruostemaa, Janne (2020)</a></p>
</li>
<li class="data-line-48">
<p><span class="icon"><i class="fa fa-book"></i></span> <a href="https://www.redeszone.net/gnu-linux/iptables-configuracion-del-firewall-en-linux-con-iptables/">De Luz, Sergio (2012)</a></p>
</li>
<li class="data-line-49">
<p><span class="icon"><i class="fa fa-book"></i></span> <a href="https://www.hostinger.com/tutorials/iptables-tutorial">S, Prithviraj (2020)</a></p>
</li>
<li class="data-line-50">
<p><span class="icon"><i class="fa fa-book"></i></span> <a href="https://asciidoctor.org/docs/user-manual/">Asciidoctor User Manual</a></p>
</li>
<li class="data-line-51">
<p><span class="icon"><i class="fa fa-book"></i></span> <a href="https://asciidoctor.org/docs/asciidoc-syntax-quick-reference/">AsciiDoc Syntax Quick Reference</a></p>
</li>
<li class="data-line-52">
<p><span class="icon"><i class="fa fa-book"></i></span> <a href="https://leanpub.com/awesomeasciidoctornotebook/read">Awesome Asciidoctor Notebook</a></p>
</li>
<li class="data-line-53">
<p><span class="icon"><i class="fa fa-book"></i></span> <a href="https://jorge-aguilera.gitlab.io/tutoasciidoc/">Tutorial superbasico AsciiDoctor</a></p>
</li>
<li class="data-line-54">
<p><span class="icon"><i class="fa fa-book"></i></span> <a href="https://marketplace.visualstudio.com/items?itemName=asciidoctor.asciidoctor-vscode">AsciiDoc support for Visual Studio Code</a></p>
</li>
<li class="data-line-55">
<p><span class="icon"><i class="fa fa-book"></i></span> <a href="https://www.ecured.cu/Iptables#:~:text=El%20proyecto%20Netfilter%2Fiptables%20comenzo,proyecto%20que%20lo%20precedi%C3%B3%2C%20Ipchains.&amp;text=iptables%20mantiene%20la%20idea%20b%C3%A1sica,qu%C3%A9%20hacer%20con%20ese%20paquete">IPTables</a></p>
</li>
<li class="data-line-56">
<p><span class="icon"><i class="fa fa-book"></i></span> <a href="https://www.linuxadictos.com/gufw-instala-un-firewall-sencillo-en-tu-distribucion-linux.html">Gufw: instala un Firewall sencillo en tu Ubuntu</a></p>
</li>
<li class="data-line-57">
<p><span class="icon"><i class="fa fa-book"></i></span> <a href="https://hipertextual.com/2018/05/red-segura-linux-cortafuegos-firewall">Asegura tu red con Linux como cortafuegos</a></p>
</li>
<li class="data-line-58">
<p><span class="icon"><i class="fa fa-book"></i></span> <a href="https://www.redeszone.net/gnu-linux/iptables-configuracion-del-firewall-en-linux-con-iptables/">Configuración del firewall en Linux con IPtables</a></p>
</li>
<li class="data-line-59">
<p><span class="icon"><i class="fa fa-book"></i></span> <a href="https://biblioteca.utb.edu.co/notas/tesis/0062642.pdf">Diseño e Implementación de Servidores/Firewall GNU-Linux con Conexión WAN</a></p>
</li>
<li class="data-line-60">
<p><span class="icon"><i class="fa fa-book"></i></span> <a href="https://mytcpip.com/nftables-firewall/">NFTables, Diseño de un Firewall Moderno</a></p>
</li>
</ul>
</div>
<hr>
<div class="paragraph text-center data-line-65">
<p><strong>HECHO</strong> CON <span class="icon"><i class="fa fa-heart fa-1x"></i></span> POR <strong>estudiantes de UNITEC</strong></p>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2020-09-20 21:45:33 -0600
</div>
</div>
</body>
</html>